version: 0.2.1

preamble: >
  using PyPlot;
  const u = 0.05;
  const datadir = joinpath("data","freesurf");
  const ni = 30;
  const nj = 150;

# data directory
datadir:    {   value: datadir,       expr: true    }

# material properties
rho_0:      {   value: 1.0,           expr: false   }
nu:         {   value: 1/3,           expr: true    }

# lattice parameters
dx:         {   value: 1.0,           expr: false   }
dt:         {   value: 1.0,           expr: false   }
ni:         {   value:  ni,           expr: true    }
nj:         {   value:  nj,           expr: true    }

# simulation parameters
simtype:    free_surface
col_f:      col_srt

# boundaries
sbounds:
  value:  "[1 ni 1 nj;]'"
  expr:   true

cbounds:
  value:  "[1 ni 1 nj;]'"
  expr:   true

# boundary conditions
bcs:
  - west_bounce_back!
  - east_bounce_back!
  - bind_south_inlet!(lat) = south_inlet!(lat, u);
  - bind_open_north!(lat) = north_pressure!(lat, 1.0);

# callback functions
#  - plot_mass_contours_callback(10, "mass", 0.0)
callbacks:
  - plot_mass_contours_callback(10)
  - print_step_callback(25, "free-surf")
  - write_jld_file_callback(datadir, 300)

# clean-up, backup, write out
finally:
  - write_jld_file_callback(datadir)
